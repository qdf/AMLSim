# Outline

[AMLSim Sample Use](#AMLSim-Sample-Use)
[Simulation Properties](#prop.ini-Documentation)

---

# AMLSim-Sample-Use
## Transaction Simulator (Java)

```bash
sh scripts/build_AMLSim.sh
sh scripts/run_AMLSim.sh [SimulationName] [Steps]
```
- SimulationName: Simulation name
- Steps: Number of steps per simulation

Example:
```bash
sh scripts/run_AMLSim.sh sample 150
```


### Example: generate transaction CSV files from small sample parameter files
Before running the Python script, please check and edit configuration file `prop.ini`.
```ini
[InputFile]
directory = paramFiles/1K
alertPattern = alertPatterns.csv
```

Then, please run transaction graph generator and simulator scripts.
```bash
cd /path/to/AMLSim
python scripts/transaction_graph_generator.py prop.ini paramFiles/1K/accounts.csv paramFiles/1K/degree.csv paramFiles/1K/transactionType.csv
sh scripts/run_AMLSim.sh sample 150
```


## Visualize a transaction subgraph of the specified alert
```bash
python scripts/visualize/plot_transaction_graph.py [TransactionLog] [AlertID]
```
- TransactionLog: Log CSV file path from AMLSim (e.g. `outputs/sample/sample_log.csv`)
- AlertID: An alert ID to be visualized


## Convert the raw transaction log file
```bash
python scripts/convert_logs.py [ConfFile] [TransactionLog]
```
- ConfFile: Configuration ini file for the data conversion (`convert.ini`)
- TransactionLog: Transaction log CSV file under `outputs/(name)/` (e.g. `outputs/sample/sample_log.csv`)

Example: 
```bash
python scripts/convert_logs.py convert.ini outputs/sample/sample_log.csv
```


## Remove all log and image files from `outputs` directory
```bash
sh scripts/clean_logs.sh
```
---

# prop.ini-Documentation

---

## General
Random seed value
```
seed = 0
```
Individual transaction amounts, currently uses the preset values from the original AMLSim library. **Need to formulate good limits to these based more realistic amounts.** Currently, transaction amounts are set within scripts/transaction_graph_generator.py where a value is choosen between the min and max set here uniformly. **Additionally need to see if a uniform distribution is the right option here based on real data.**
Minimum individual transaction amount, default is 1
```
default_min_amount = 1
```
Maximum individual transaction amount, default is 10000
```
default_max_amount = 10000
```
Total number of simulation steps, preset is 200. **Is 200 enough?**
```
total_step = 200
```
## Base
Accounts with larger degree than this threshold will be selected as alert accounts. **Is this a good rule to have? Is having a large degree producing large amounts of false alerts? When need to check the accuracy of this rule**
```
degree_threshold = 10
```
## HighRisk
High-risk business types and countries (comma-separated). Currently set to none, however easy to incorporate autogenerated data of organizations from customer segmentation work.
```
business = ""
countries = ""
```
## InputFile
Input file and directory path. Currenlty set to one of the samples within the AMLSim repo. Can use this for now, but would be good to incorporate our generated data into this. **Need to build a script that formats our data in the expected format of these examples**
```
directory = paramFiles/1m
alertPattern = alertPatterns.csv

is_aggregated = True
```
## OutputFile
Output and intermediate file and directory path. For now, no reason to change these unless we want to change the directory structure. This will overwrite some existing files, so back up prior work before running additional simulations.
```
directory = outputs
transactions = transactions.csv
accounts = accounts.csv
alert_members = alert_members.csv
counter_log = tx_count.csv
diameter_log = diameter.csv
```
## PlotFile
Output file for visualizations. Also no reason to change these at the moment, unless needed to change the directory structure. Also these are outputs meant for the visualization scripts for the most part.
```
degree = deg.png
wcc = wcc.png
alert = alert.png
count = count.png
clustering = cc.png
diameter = diameter.png
```
